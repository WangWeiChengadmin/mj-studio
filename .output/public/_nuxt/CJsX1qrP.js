import{C as c}from"./DZ_1_TWT.js";function O(){const r=c("upstreams",()=>[]),u=c("upstreams-loading",()=>!1);async function d(){u.value=!0;try{const e=await $fetch("/api/upstreams");r.value=e}catch(e){console.error("加载上游配置失败:",e)}finally{u.value=!1}}async function p(e){const t=await $fetch("/api/upstreams",{method:"POST",body:e});return r.value.push(t),r.value.sort((a,s)=>a.sortOrder-s.sortOrder),t}async function o(e,t){const a=await $fetch(`/api/upstreams/${e}`,{method:"PUT",body:t}),s=r.value.findIndex(n=>n.id===e);return s>=0&&(r.value[s]=a),r.value.sort((n,y)=>n.sortOrder-y.sortOrder),a}async function m(e){if(!r.value.find(n=>n.id===e))return;const a=Math.min(...r.value.map(n=>n.sortOrder)),s=(a>0,a-1);return o(e,{sortOrder:s})}async function f(e){await $fetch(`/api/upstreams/${e}`,{method:"DELETE"}),r.value=r.value.filter(t=>t.id!==e)}function i(e){return r.value.find(t=>t.id===e)}function l(e,t){return i(e)?.aimodels.find(s=>s.id===t)}async function v(e){const t=await $fetch(`/api/upstreams/${e}/balance`);if(t.success&&t.upstreamInfo){const a=r.value.findIndex(s=>s.id===e);a>=0&&(r.value[a].upstreamInfo=t.upstreamInfo)}return t}return{upstreams:r,isLoading:u,loadUpstreams:d,createUpstream:p,updateUpstream:o,moveToTop:m,deleteUpstream:f,getUpstreamById:i,getAimodelById:l,queryBalance:v}}export{O as u};
