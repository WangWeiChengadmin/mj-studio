import{C as l,m as C,g as y}from"./DZ_1_TWT.js";function $(){const s=l("assistants",()=>[]),u=l("assistants-loading",()=>!1),e=C(null),f=y(()=>e.value?s.value.find(t=>t.id===e.value):null);function c(){return s.value.find(t=>t.isDefault)||s.value[0]||null}async function r(){u.value=!0;try{const t=await $fetch("/api/assistants");s.value=t}catch(t){console.error("加载助手列表失败:",t)}finally{u.value=!1}}function v(t){e.value=t}async function d(t){const n=await $fetch("/api/assistants",{method:"POST",body:t});return t.isDefault&&s.value.forEach(a=>{a.isDefault=!1}),s.value.unshift({...n,conversationCount:0}),n}async function h(t,n){const a=await $fetch(`/api/assistants/${t}`,{method:"PUT",body:n});n.isDefault&&s.value.forEach(i=>{i.id!==t&&(i.isDefault=!1)});const o=s.value.findIndex(i=>i.id===t);return o>=0&&(s.value[o]=a),a}async function A(t){if(await $fetch(`/api/assistants/${t}`,{method:"DELETE"}),s.value=s.value.filter(n=>n.id!==t),e.value===t){const n=s.value.find(a=>a.isDefault)||s.value[0];e.value=n?.id||null}}function m(t){const n=s.value.find(a=>a.id===t);n&&n.conversationCount++}function p(t){const n=s.value.find(a=>a.id===t);n&&n.conversationCount>0&&n.conversationCount--}return{assistants:s,isLoading:u,currentAssistantId:e,currentAssistant:f,getDefaultAssistant:c,loadAssistants:r,selectAssistant:v,createAssistant:d,updateAssistant:h,deleteAssistant:A,incrementConversationCount:m,decrementConversationCount:p}}export{$ as u};
